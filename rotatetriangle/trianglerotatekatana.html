<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    
    <title>trianglerotatekatana.cdy</title>
    <style type="text/css">
        * {
            margin: 0px;
            padding: 0px;
        }

        #CSConsole {
            background-color: #FAFAFA;
            border-top: 1px solid #333333;
            bottom: 0px;
            height: 200px;
            overflow-y: scroll;
            position: fixed;
            width: 100%;
        }
    </style>
    <link rel="stylesheet" href="https://cindyjs.org/dist/v0.8/CindyJS.css">
    <script type="text/javascript" src="https://cindyjs.org/dist/v0.8/Cindy.js"></script>
    <script type="text/javascript" src="https://cindyjs.org/dist/v0.8/KetCindyPlugin.js"></script>
<script id="csinit" type="text/x-cindyscript">
use("KetCindyPlugin");
Dircdy=loaddirectory;
setdirectory(plugindirectory);
import("ketcindy.ini");

tL=[];
;
</script>
<script id="csdraw" type="text/x-cindyscript">
Ketinit();
Setparent(Cdyname()+"fig");
Setketcindyjs(["Size=1","No=all","Col=[0,0,0,0.2]"]);

Addax(0);

div=50;
A.xy=2*[0,2];
B.xy=2*[-sqrt(3),-1];
C.xy=2*[sqrt(3),-1];

a=|C-B|; b=|A-C|; c=|B-A|;
len=a+b+c;
Delta=(len/2)/div;

Slider("S",[-len/4,YMIN-0.5],[len/4,YMIN-0.5]);

Listplot("P",[A,B,C,A],["dr,2"]);
Shade(["sgP"],["Color=greenyellow"]);

Triangle(s):=(
  regional(t,p1,p2,p3);
  if(s<c,
    t=s/c; p1=(1-t)*A+t*B;
    ,
    if(s<c+a,
      t=(s-c)/a; p1=(1-t)*B+t*C;
    ,
      t=(s-c-a)/b; p1=(1-t)*C+t*A;
    );
  );
  if(s<a,
    t=s/a; p2=(1-t)*B+t*C;
    ,
    if(s<a+b,
      t=(s-a)/b; p2=(1-t)*C+t*A;
    ,
      t=(s-a-b)/c; p2=(1-t)*A+t*B;
    );
  );
  if(s<c,
    t=s/c; p3=(1-t)*C+t*A;
    ,
    if(s<b+c,
      t=(s-c)/b; p3=(1-t)*A+t*B;
    ,
      t=(s-b-c)/a; p3=(1-t)*B+t*C;
    );
  );
  [round(s/Delta),p1,p2,p3];
);

Ch=[1];
if(contains(Ch,1),
 n2=floor(2*(S.x+len/4)/Delta);
 tL=select(tL,#_1<n2);
 if(length(tL)==0,
   n1=0;
 ,
   n1=max(apply(tL,#_1));
 );
 ctr=1;
 forall(tL,
   p1=#_2; p2=#_3; p3=#_4;
   // Pointdata(text(ctr),[p1,p2,p3],["Size=3","Color=blue"]);
   Listplot(text(ctr),[p1,p2,p3,p1],["Color=blueviolet"]);
   ctr=ctr+1;
 );
 forall(n1..n2,
   s=#*Delta;
   dt=Triangle(s);
   p1=dt_2; p2=dt_3; p3=dt_4;
   if(#==n2,
     Pointdata(text(ctr),[p1,p2,p3],["Size=3","Color=blue"]);
   );
   Listplot(text(ctr),[p1,p2,p3,p1],["Color=blueviolet"]);
   tL=append(tL,dt);
   ctr=ctr+1;
 );
);

if(contains(Ch,2),
 mf(n):=(
  regional(dt,p1,p2,p3);
  forall(0..n,
    dt=Triangle(#*Delta);
    p1=dt_2; p2=dt_3; p3=dt_4;
    if(#==n,
      Pointdata(text(#),[p1,p2,p3],["Size=3","Color=blue"]);
    );
    Listplot(text(#),[p1,p2,p3,p1],["Color=blueviolet"]);
  );
 );
 rng=Assign("n=[0,div]",["div",div]);
 Setpara("trianglerotate","mf(n)",rng,["Div="+div]);
);//1

Figpdf();
Windispg();
;
</script>
    <script type="text/javascript">
var cdy = CindyJS({
  scripts: "cs*",
  defaultAppearance: {
    dimDependent: 0.7,
    fontFamily: "sans-serif",
    lineSize: 1,
    pointSize: 5.0,
    textsize: 12.0
  },
  angleUnit: "Â°",
  geometry: [
    {name: "SW", type: "Free", pos: [4.0, 2.5, -1.0], color: [1.0, 0.0, 0.0], labeled: true},
    {name: "NE", type: "Free", pos: [-3.5555555555555554, -4.0, -0.8888888888888888], color: [1.0, 0.0, 0.0], labeled: true},
    {name: "A", type: "Free", pos: [-0.0, -4.0, -1.0], color: [1.0, 0.0, 0.0], labeled: true},
    {name: "B", type: "Free", pos: [4.0, 2.3094010767585034, -1.1547005383792517], color: [1.0, 0.0, 0.0], labeled: true},
    {name: "C", type: "Free", pos: [4.0, -2.3094010767585034, 1.1547005383792517], color: [1.0, 0.0, 0.0], labeled: true},
    {name: "S", type: "Free", pos: [4.0, 2.3094021535175075, -0.7698007178391693], color: [1.0, 0.0, 0.0], labeled: true},
    {name: "Text1", type: "Button", color: [0.0, 0.0, 0.0], fillcolor: [1.0, 0.286, 0.286], fillalpha: 0.27272728085517883, script: "Viewtex();\nkc();", text: "Figure", textsize: 18.0, dock: {corner: "UL", offset: [10.0, -20.0]}},
    {name: "Text2", type: "Button", color: [0.0, 0.0, 0.0], fillcolor: [1.0, 1.0, 0.0], fillalpha: 0.27272728085517883, script: "if(length(Shellparent)>0,\n  Makeshell(),Makebat();\n);\nWritetoSci(2);\nkc();", text: "Parent", textsize: 18.0, dock: {corner: "UL", offset: [77.0, -20.0]}},
    {name: "Text21", type: "Button", color: [0.0, 0.0, 0.0], fillcolor: [0.0, 1.0, 1.0], fillalpha: 0.27272728085517883, script: "Mkketcindyjs();", text: "KeTJS", textsize: 18.0, dock: {corner: "UL", offset: [488.0, -20.0]}},
    {name: "Text22", type: "Button", color: [0.0, 0.0, 0.0], fillcolor: [0.0, 1.0, 1.0], fillalpha: 0.27272728085517883, script: "Mkketcindyjs(append(Ketjsoption(),\"Web=n\"));\n", text: "KeTJSoff", textsize: 18.0, dock: {corner: "UL", offset: [551.0, -20.0]}},
    {name: "Text0'", type: "Button", color: [0.0, 0.0, 0.0], fillcolor: [1.0, 0.929, 0.6], fillalpha: 0.27272728085517883, script: "Parafolder();", text: "ParaF", textsize: 18.0, dock: {corner: "UL", offset: [143.0, -20.0]}},
    {name: "Text05", type: "Button", color: [0.0, 0.0, 0.0], fillcolor: [0.51, 0.949, 1.0], fillalpha: 0.27272728085517883, script: "Mkanimation();", text: "Anime", textsize: 18.0, dock: {corner: "UL", offset: [202.0, -20.0]}},
    {name: "Text04'", type: "Button", color: [0.0, 0.0, 0.0], fillcolor: [0.0, 0.0, 1.0], fillalpha: 0.27272728085517883, script: "Mkflipanime();", text: "Flip", textsize: 18.0, dock: {corner: "UL", offset: [270.0, -20.0]}},
    {name: "Text05'", type: "Button", color: [0.0, 0.0, 0.0], fillcolor: [0.51, 0.949, 1.0], fillalpha: 0.27272728085517883, script: "Mkanimation();", text: "Anime", textsize: 18.0, dock: {corner: "UL", offset: [202.0, -20.0]}},
    {name: "Text04''", type: "Button", color: [0.0, 0.0, 0.0], fillcolor: [0.0, 0.0, 1.0], fillalpha: 0.27272728085517883, script: "Mkflipanime();", text: "Flip", textsize: 18.0, dock: {corner: "UL", offset: [270.0, -20.0]}}
  ],
  ports: [{
    id: "CSCanvas",
    width: 1013,
    height: 599,
    transform: [{visibleRect: [-8.182374581488089, 5.321930845549291, 7.068307021175084, -3.695994406173553]}],
    axes: true,
    grid: 0.25,
    snap: true,
    background: "rgb(168,176,192)"
  }],
  csconsole: false,
  cinderella: {build: 1901, version: [2, 9, 1901]}
});
    </script>
</head>
<body>
    <div id="CSCanvas"></div>
</body>
</html>